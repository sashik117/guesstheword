package pages;

import entity.User;
import java.util.HashMap;
import java.util.Map;
import java.util.Random;
import java.util.Scanner;
import service.GameService;

public class GameView {

    private static final Map<String, String> hints = new HashMap<>();

    static {
        hints.put("яблуко", "Це фрукт, який часто асоціюється з початком нового дня.");
        hints.put("банан", "Цей фрукт має жовтий колір і часто асоціюється з маймунками.");
        hints.put("перо", "Це частина птаха, яке допомагає йому літати.");
        hints.put("собака", "Цей звір — найкращий друг людини.");
        hints.put("квітка", "Це рослина, яка часто дарується в подарунок.");
        hints.put("річка", "Це водойма, по якій часто рухаються човни.");
        hints.put("дерево", "Це рослина, яка має стовбур і гілки.");
        hints.put("стіл", "Цей предмет меблів зазвичай використовується для їжі або роботи.");
        hints.put("машина",
            "Це транспортний засіб, який часто використовується для поїздок на великі відстані.");
        hints.put("телефон", "Цей пристрій дозволяє нам спілкуватися на відстані.");
        hints.put("комп'ютер",
            "Це пристрій, який використовують для роботи, розваг та спілкування.");
        hints.put("книга", "Це джерело знань та інформації, яке має багато сторінок.");
        hints.put("школа", "Місце, де діти навчаються.");
        hints.put("місто", "Велика урбанізована територія з багатьма будівлями та дорогами.");
        hints.put("роза", "Ця квітка має колючки і часто асоціюється з коханням.");
        hints.put("світло", "Це енергія, яка дозволяє нам бачити навколишній світ.");
        hints.put("гора", "Висока природна форма земної поверхні.");
        hints.put("птах", "Тварина, яка має крила і може літати.");
        hints.put("телевізор", "Пристрій, за допомогою якого ми переглядаємо програми та фільми.");
        hints.put("друзі",
            "Люди, з якими ми проводимо час і з якими нас пов'язують позитивні емоції.");
        hints.put("сніг", "Льодові кристали, що випадають з неба в холодну пору року.");
        hints.put("дощ", "Волога, яка падає з неба у вигляді крапель.");
        hints.put("гроші", "Це засіб обміну та збереження вартості.");
        hints.put("молоко", "Продукт, що виділяється ссавцями і часто вживається людьми.");
        hints.put("сіль", "Продукт, що використовується в кулінарії для підсилення смаку.");
        hints.put("кава", "Напій, виготовлений з обсмажених кавових зерен.");
        hints.put("хліб", "Основний продукт харчування, виготовлений з борошна, води та дріжджів.");
        hints.put("колесо", "Цей об'єкт допомагає транспортним засобам рухатись.");
        hints.put("сонце", "Наша зірка, яка дає світло і тепло.");
        hints.put("місяць", "Супутник Землі, який видно вночі.");
        hints.put("зима", "Пір року, коли температура найнижча.");
        hints.put("літо", "Пір року, коли температура найвища.");
        hints.put("весна", "Пір року, коли природа прокидається після зими.");
        hints.put("осінь", "Пір року, коли листя змінює колір на жовтий і червоний.");
        hints.put("сміх", "Звук, що видається при вираженні радості чи гумору.");
        hints.put("пісня", "Мелодійний твір, який часто супроводжується словами.");
        hints.put("зуби", "Частини рота, що використовуються для пережовування їжі.");
        hints.put("ліс", "Велика територія, покрита деревами.");
        hints.put("море", "Велика водойма, що оточує континенти.");
        hints.put("пташка", "Малий птах, який часто живе в садах і парках.");
        hints.put("корова", "Тварина, що дає молоко.");
        hints.put("ріка", "Велика природна водна артерія.");
        hints.put("камінь", "Твердий природний матеріал.");
        hints.put("папір", "Матеріал, виготовлений з деревини, на якому можна писати.");
        hints.put("олівець", "Інструмент для письма з графітовим стрижнем.");
        hints.put("сірник", "Малий предмет для запалювання вогню.");
        hints.put("сова", "Нічний птах, відомий своїм здатністю бачити в темряві.");
        hints.put("сірка",
            "Мінімальна кількість речовини, що використовуються для запалювання вогню.");
        hints.put("свиня", "Тварина, яка дає м'ясо для виробів.");
        hints.put("двері", "Об'єкт, який відкривається для входу чи виходу з приміщення.");
        hints.put("вікно", "Отвір в стіні для провітрювання і світла.");
        hints.put("помідор", "Фрукт, червоного кольору, який часто використовується в салатах.");
        hints.put("сир", "Продукт, виготовлений з молока.");
        hints.put("село", "Мала населене місце, де зазвичай живуть селяни.");
        hints.put("вода", "Жидкість, що необхідна для життя.");
        hints.put("підлога", "Частина приміщення, на якій ми ходимо.");
        hints.put("груша", "Фрукт, що має форму, схожу на пляшку.");
        hints.put("вишня", "Фрукт, який є червоним і солодким.");
        hints.put("полуниця", "Фрукт червоного кольору, що росте на маленькому кущику.");
        hints.put("морква", "Овоч, який має яскраво-оранжевий колір.");
        hints.put("огірок", "Овоч, який зазвичай зелений і часто використовується в салатах.");
        hints.put("яйце", "Продукт, що дається птахами і вживається в їжу.");
        hints.put("масло", "Жирна речовина, отримана з молока або рослин.");
        hints.put("цукор", "Солодка речовина, що використовується для підсолоджування.");
        hints.put("кіт", "Домашня тварина, яка часто ласкава.");
        hints.put("кінь", "Тварина, яку часто використовують для їзди.");
        hints.put("лев", "Цар звірів.");
        hints.put("вовк", "Дика тварина, яка живе в лісах.");
        hints.put("гусак", "Велика птах, яка живе біля води.");
        hints.put("риба", "Тварина, що живе в воді.");
        hints.put("миша", "Маленька гризун, часто живе в будинках.");
        hints.put("жаба", "Тварина, що часто живе біля води і має слизьку шкіру.");
        hints.put("небо", "Частина атмосфери, яку ми бачимо над собою.");
        hints.put("трава", "Рослина, яка покриває більшу частину земної поверхні.");
        hints.put("хмара", "Вологості повітря, що формують скупчення в небі.");
        hints.put("вітер", "Рух повітря з високого до низького тиску.");
        hints.put("пісок", "Маленькі частинки каміння, які утворюють пляжі.");
        hints.put("озеро", "Велика водойма, але менша за море.");
        hints.put("поле",
            "Територія, покрита травою, зазвичай використовується для сільського господарства.");
        hints.put("грім", "Гучний звук, що супроводжує блискавку.");
        hints.put("лампа", "Пристрій для освітлення.");
        hints.put("ліжко", "Предмет меблів для сну.");
        hints.put("ручка", "Предмет для письма.");
        hints.put("сумка", "Вмістилище для носіння речей.");
        hints.put("чашка", "Ємність для пиття, зазвичай для чаю чи кави.");
    }

    public GameView(GameService gameService) {
    }

    public void displayGame(Scanner scanner, GameService gameService, User user) {
        String[] words = {
            "яблуко", "банан", "перо", "собака", "квітка", "річка", "дерево", "стіл", "машина",
            "телефон", "комп'ютер", "книга", "школа", "місто", "роза", "світло", "гора", "птах",
            "телевізор", "друзі", "сніг", "дощ", "гроші", "молоко", "сіль", "кава", "хліб",
            "колесо", "сонце", "місяць", "зима", "літо", "весна", "осінь", "сміх", "пісня", "зуби",
            "ліс", "море", "пташка", "корова", "ріка", "камінь", "папір", "олівець", "сірник",
            "сова", "сірка", "свиня", "двері", "вікно", "помідор", "сир", "село", "вода", "підлога",
            "груша", "вишня", "полуниця", "морква", "огірок", "яйце", "масло", "цукор", "кіт",
            "кінь", "лев", "вовк", "гусак", "риба", "миша", "жаба", "небо", "трава", "хмара",
            "вітер", "пісок", "озеро", "поле", "грім", "лампа", "ліжко", "ручка", "сумка", "чашка"
        };

        Random random = new Random();
        String wordToGuess = words[random.nextInt(words.length)].toLowerCase();

        if (!wordToGuess.matches("[а-яА-ЯіІїЇєЄґҐ]+")) {
            System.out.println("Помилка! Слово містить некоректні символи.");
            return;
        }

        StringBuilder hiddenWord = new StringBuilder(wordToGuess.replaceAll(".", "_"));
        String guessedLetters = "";
        int attemptsLeft = 11;
        boolean gameWon = false;

        System.out.println("********************************");
        System.out.println("   Почнемо гру: Вгадай слово!");
        System.out.println("********************************");

        while (!hiddenWord.toString().equals(wordToGuess) && attemptsLeft > 0) {
            System.out.println("\nСлово: " + hiddenWord);
            System.out.println("Використані літери: " + guessedLetters);
            System.out.println("Залишилось спроб: " + attemptsLeft);
            System.out.println("===========================================");
            System.out.print("Введіть букву або 'вихід' щоб вийти: ");

            String input = scanner.nextLine().toLowerCase();

            if (input.equals("вихід")) {
                System.out.println("Дякуємо за гру! До побачення!");
                break;
            }

            if (input.length() == 1 && input.matches("[а-яА-ЯіІїЇєЄґҐ]")) {
                if (guessedLetters.contains(input)) {
                    System.out.println("\u001B[33m❗️ Ви вже використовували цю літеру!\u001B[0m");
                    continue;
                }

                guessedLetters += input;

                if (wordToGuess.contains(input)) {
                    System.out.println(
                        "\u001B[32m✅ Вірно! Буква " + input + " є в слові.\u001B[0m");
                    for (int i = 0; i < wordToGuess.length(); i++) {
                        if (wordToGuess.charAt(i) == input.charAt(0)) {
                            hiddenWord.setCharAt(i, input.charAt(0));
                        }
                    }
                } else {
                    attemptsLeft--;
                    System.out.println(
                        "\u001B[31m❌ Невірно! Буква " + input + " відсутня в слові.\u001B[0m");

                    // Показати підказку після 10 невдалих спроб (залишилось 5)
                    if (attemptsLeft == 5 && hints.containsKey(wordToGuess)) {
                        System.out.println(
                            "\u001B[36m💡 Підказка: " + hints.get(wordToGuess) + "\u001B[0m");
                    }
                }
            } else {
                System.out.println(
                    "\u001B[35m⚠️ Будь ласка, введіть лише одну кириличну букву.\u001B[0m");
            }
        }

        if (hiddenWord.toString().equals(wordToGuess)) {
            System.out.println(
                "\u001B[34m🎉 Вітаємо! Ви вгадали слово: " + wordToGuess + " 🎉\u001B[0m");
            gameWon = true;
        } else {
            System.out.println(
                "\u001B[31m😞 Вибачте, ви програли! Слово було: " + wordToGuess + "\u001B[0m");
        }

        if (gameWon) {
            user.incrementWordsGuessed();
        }

        user.incrementGamesPlayed();
    }
}